并发日志这一块网上的资料比较少，找了半天，大多数都是讲下syslog函数怎么用，然后就没了，后来看了陈硕的《高性能服务器端编程》，很有收获。    
以下内容主要摘自陈硕的《高性能服务器端编程》  

# 1.日志记录的内容
对于关键进程，日志通常要记录  
1.收到的每条内部消息的id  
2.收到的每条外部消息的全文  
3.发出的每条消息的全文，每条消息都有全局唯一的id  
4.关键内部状态的变更等等  

使用stream风格比较好，首先不用像printf那样保持参数格式的一致，同时是类型安全的，其次当输出的日志级别高于语句的日志级别时，打印日志是一个空操作，开销基本为0  
日志消息需要有多种级别，如DEBUG、INFO、ERROR等  

需要注意往网络写日志是不可靠的！！

日志的滚动功能是必须的，可以设置为每满一个大小就换下一个文件，每过一段时间就换下一个文件  

# 2.日志的结构
一个日志库大体可以分为前端和后端，前端是供来调用的接口api，并生成日志消息，后端负责把前端接受的消息写到目的地    
这是一个典型的多生产者-单消费者问题，对于生产者而言，需要尽量做到低延迟，低cpu开销，无阻塞，对消费者而言，需要做到足够大的吞吐量，并占用较少资源    


